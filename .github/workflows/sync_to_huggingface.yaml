name: Sync to HuggingFace ü§ó hub

on:
  push:
    branches: [main]
  workflow_dispatch:

env:
  HF_USER: ealizadeh
  HF_REPO: ealizadeh/gaia-agent

jobs:
  sync-to-hf-hub:
    runs-on: ubuntu-latest

    steps:
      - name: Check out repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          lfs: true

      - name: Verify ü§ó HF repo exists
        run: |
          if git ls-remote "https://huggingface.co/${HF_REPO}.git" &> /dev/null; then
            echo "‚úÖ HF repo found: ${HF_REPO}"
          else
            echo "‚ùå HF repo not found at https://huggingface.co/${HF_REPO}.git" && exit 1
          fi

      - name: Push to HF repo ü§ó
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          echo "‚Üí Pushing local 'main' ‚Üí HF '${HF_REPO}' (force)"
          if git push -f "https://${HF_USER}:$HF_TOKEN@huggingface.co/${HF_REPO}.git" main; then
            echo "‚úÖ Push succeeded."
          else
            echo "‚ùå Push failed. Double-check 'HF_TOKEN' and permissions." && exit 1
          fi
